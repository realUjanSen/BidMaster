<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auction Details - BidMaster</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body class="bg-dark text-light">    <!-- Custom Navigation -->
    <nav class="custom-navbar">
        <div class="container">
            <div class="navbar-content">
                <div class="navbar-brand">
                    <a href="/" class="brand-link">
                        <i class="bi bi-hammer"></i>
                        <span class="brand-text">BidMaster</span>
                    </a>
                </div>
                
                <div class="navbar-menu" id="navbarMenu">
                    <a href="/" class="nav-link">
                        <i class="bi bi-house-door"></i>
                        <span>Home</span>
                    </a>
                    <a href="/my-auctions" class="nav-link">
                        <i class="bi bi-person-circle"></i>
                        <span>My Auctions</span>
                    </a>
                    <a href="/create-auction" class="nav-link">
                        <i class="bi bi-plus-circle"></i>
                        <span>Create Auction</span>
                    </a>
                    <a href="/login" class="nav-link login-btn">
                        <i class="bi bi-box-arrow-in-right"></i>
                        <span>Login</span>
                    </a>
                </div>
                
                <div class="mobile-toggle" id="mobileToggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </nav>

    <style>
        .custom-navbar {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
        }

        .navbar-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 0;
        }

        .navbar-brand {
            flex-shrink: 0;
        }

        .brand-link {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: #fff;
            font-size: 1.5rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .brand-link:hover {
            color: #4fc3f7;
            transform: scale(1.05);
        }

        .brand-link i {
            margin-right: 0.5rem;
            font-size: 1.8rem;
            color: #4fc3f7;
        }

        .brand-text {
            background: linear-gradient(45deg, #4fc3f7, #29b6f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .navbar-menu {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1.25rem;
            text-decoration: none;
            color: rgba(255, 255, 255, 0.8);
            border-radius: 25px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .nav-link:hover {
            color: #fff;
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .nav-link.active {
            background: linear-gradient(135deg, #4fc3f7, #29b6f6);
            color: #fff;
            box-shadow: 0 4px 15px rgba(79, 195, 247, 0.3);
        }

        .nav-link i {
            margin-right: 0.5rem;
            font-size: 1.1rem;
        }

        .login-btn {
            border: 1px solid #4fc3f7;
            color: #4fc3f7;
        }

        .login-btn:hover {
            background: #4fc3f7;
            color: #fff;
        }

        .mobile-toggle {
            display: none;
            flex-direction: column;
            cursor: pointer;
            padding: 0.5rem;
        }

        .mobile-toggle span {
            width: 25px;
            height: 3px;
            background: #fff;
            margin: 3px 0;
            transition: 0.3s;
            border-radius: 2px;
        }

        @media (max-width: 768px) {
            .navbar-menu {
                position: fixed;
                top: 80px;
                left: -100%;
                width: 100%;
                height: calc(100vh - 80px);
                background: rgba(26, 26, 46, 0.95);
                backdrop-filter: blur(20px);
                flex-direction: column;
                justify-content: flex-start;
                align-items: center;
                padding-top: 2rem;
                transition: left 0.3s ease;
                gap: 1rem;
            }

            .navbar-menu.active {
                left: 0;
            }

            .mobile-toggle {
                display: flex;
            }

            .nav-link {
                width: 200px;
                justify-content: center;
            }
        }
    </style>    <!-- Breadcrumb -->
    <div class="container mt-3">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/">Home</a></li>
                <li class="breadcrumb-item"><a href="/auctions">Auctions</a></li>
                <li class="breadcrumb-item active">{{ auction.title }}</li>
            </ol>
        </nav>
    </div>

    <!-- Auction Details -->
    <div class="container my-4">
        <div class="row">
            <!-- Images Section -->
            <div class="col-lg-6">
                <div class="auction-gallery mb-3">
                    <div class="main-image-container">
                        <img id="mainImage" src="{{ auction.image_url }}" class="main-image rounded" alt="{{ auction.title }}">
                    </div>
                </div>
            </div>

            <!-- Auction Info Section -->
            <div class="col-lg-6">
                <div class="sticky-top" style="top: 120px;">
                    <div class="d-flex align-items-center mb-3">
                        <h1 class="me-3">{{ auction.title }}</h1>
                        <span class="badge bg-{{ auction.badge_color }} fs-6">{{ auction.badge }}</span>
                    </div>
                    
                    <p class="text-muted mb-4">{{ auction.description }}</p>
                    
                    <!-- Current Bid Info -->
                    <div class="card mb-4">
                        <div class="card-body">
                            <div class="row text-center">
                                <div class="col-4">
                                    <h3 class="text-primary mb-0">${{ "{:,}".format(auction.current_bid) }}</h3>
                                    <small class="text-muted">Current Bid</small>
                                </div>
                                <div class="col-4">
                                    <h3 class="text-success mb-0">{{ auction.total_bids }}</h3>
                                    <small class="text-muted">Total Bids</small>
                                </div>
                                <div class="col-4">
                                    <h3 class="text-warning mb-0">{{ auction.time_left }}</h3>
                                    <small class="text-muted">Time Left</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Bidding Form -->
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="bi bi-hammer"></i> Place Your Bid</h5>
                        </div>
                        <div class="card-body">
                            <form id="bidForm">
                                <div class="input-group mb-3">
                                    <span class="input-group-text">$</span>
                                    <input type="number" id="bidAmount" class="form-control" placeholder="Enter bid amount" min="{{ auction.current_bid + 50 }}" step="50">
                                    <button class="btn btn-primary" type="submit">
                                        <i class="bi bi-hammer"></i> Place Bid
                                    </button>
                                </div>
                                <small class="text-muted">Minimum bid: ${{ "{:,}".format(auction.current_bid + 50) }} (current bid + $50)</small>
                            </form>
                        </div>
                    </div>

                    <!-- Seller Info -->
                    <div class="card">
                        <div class="card-body">
                            <h6 class="card-title">Seller Information</h6>
                            <div class="d-flex align-items-center">
                                <div class="seller-avatar me-3">
                                    <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                        {{ auction.seller_name[0] if auction.seller_name else 'U' }}
                                    </div>
                                </div>
                                <div>
                                    <strong>{{ auction.seller_name or 'Unknown Seller' }}</strong>
                                    <div class="text-muted small">
                                        <i class="bi bi-star-fill text-warning"></i> 4.8 (25 reviews)
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bid History -->
        <div class="row mt-5">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-clock-history"></i> Bid History</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Bidder</th>
                                        <th>Bid Amount</th>
                                        <th>Date & Time</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% if auction.recent_bids %}
                                        {% for bid in auction.recent_bids %}
                                        <tr {% if loop.index == 1 %}class="table-success"{% endif %}>
                                            <td>{% if loop.index == 1 %}<strong>{{ bid.bidder_name }}</strong>{% else %}{{ bid.bidder_name }}{% endif %}</td>
                                            <td>{% if loop.index == 1 %}<strong>${{ "{:,}".format(bid.bid_amount) }}</strong>{% else %}<strong>${{ "{:,}".format(bid.bid_amount) }}</strong>{% endif %}</td>
                                            <td>{{ bid.bid_time.strftime('%Y-%m-%d %H:%M') }}</td>
                                            <td>{% if loop.index == 1 %}<span class="badge bg-success">Winning</span>{% else %}<span class="badge bg-secondary">Outbid</span>{% endif %}</td>
                                        </tr>
                                        {% endfor %}
                                    {% else %}
                                        <tr>
                                            <td colspan="4" class="text-center text-muted">No bids yet. Be the first to bid!</td>
                                        </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>        <!-- Item Details -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-info-circle"></i> Item Details</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6>Specifications</h6>
                                <ul class="list-unstyled">
                                    {% for key, value in auction.specifications.items() %}
                                    <li><strong>{{ key }}:</strong> {{ value }}</li>
                                    {% endfor %}
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6>Condition & Details</h6>
                                <ul class="list-unstyled">
                                    {% for key, value in auction.condition.items() %}
                                    <li><strong>{{ key }}:</strong> {{ value }}</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <style>
        .auction-gallery {
            max-width: 100%;
        }

        .main-image-container {
            position: relative;
            overflow: hidden;
            border-radius: 15px;
            background: var(--bs-dark);
            border: 1px solid var(--bs-secondary);
        }

        .main-image {
            width: 100%;
            height: 400px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .main-image:hover {
            transform: scale(1.05);
        }

        .thumbnail-container {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .thumbnail-image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .thumbnail-image:hover {
            border-color: #4fc3f7;
            transform: scale(1.1);
        }

        .thumbnail-image.active {
            border-color: #4fc3f7;
            box-shadow: 0 0 10px rgba(79, 195, 247, 0.5);
        }

        .seller-avatar {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #4fc3f7, #29b6f6);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        @media (max-width: 768px) {
            .thumbnail-image {
                width: 60px;
                height: 60px;
            }
            
            .main-image {
                height: 300px;
            }
        }
    </style>

    <script>
        function changeMainImage(imageSrc, thumbnail) {
            document.getElementById('mainImage').src = imageSrc;
            
            // Remove active class from all thumbnails
            document.querySelectorAll('.thumbnail-image').forEach(img => {
                img.classList.remove('active');
            });
            
            // Add active class to clicked thumbnail
            thumbnail.classList.add('active');
        }
    </script>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5><i class="bi bi-hammer"></i> BidMaster</h5>
                    <p class="text-muted">Your trusted online auction platform</p>
                </div>
                <div class="col-md-6 text-end">
                    <p class="text-muted">&copy; 2025 BidMaster. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='scripts.js') }}"></script>
    
    <script>
        document.getElementById('bidForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const bidAmount = document.getElementById('bidAmount').value;
            const auctionId = {{ auction.id }};
            
            if (!bidAmount || bidAmount <= {{ auction.current_bid }}) {
                alert('Please enter a valid bid amount higher than the current bid.');
                return;
            }
            
            fetch('/api/place-bid', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    auction_id: auctionId,
                    bid_amount: bidAmount
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert(data.message);
                    location.reload(); // Refresh to show new bid
                } else {
                    alert('Error: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error placing bid. Please try again.');
            });
        });
    </script>
</body>
</html>
